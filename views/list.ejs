<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Application List - Jetronome</title>
    <link href="https://fonts.googleapis.com/css?family=Nanum+Gothic" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css" />
</head>

<body>
    <h1>Application List</h1>
    <small>Page generated at <%= locals.getTimeStr(new Date()); %></small>

    <%
        var ips = Object.keys(locals.apps);
        var i = 0;
        var el = null;
        for (i = 0; i < ips.length; i++) {
            el = locals.apps[ips[i]];
            var nameOfIp = locals.getNameOfIp(ips[i]);
            var nameForProperty = (nameOfIp || '').replace(/'/gi, '\\\'');
    %>
            <h3><%= ips[i] %><%= (nameOfIp) ? ' - ' + nameOfIp : '' %> <small onclick="renameIp('<%= ips[i] %>', '<%= nameForProperty %>')">[#]</small></h3>
            <div class="appListWrap">
            <%
                var j = 0;
                var app = null;
                for (j = 0; j < el.length; j++) {
                    app = el[j];
            %>
                    <div class="<%= (app.isOk) ? 'ok' : 'notOk' %>" id="app_<%= app.id %>">
                        <strong class="appName"><%= app.name %> <small class="removeApp" onclick="removeApp('<%= app.name %>')">[Ã—]</small></strong>
                        <span class="appDesc">
                            <span class="appDescTxt"><%= app.description %></span>
                            <a class="testApiLink" href="<%= app.testApi %>" target="_blank">[Test API]</a>
                            <span class="lastSignal"><%= locals.getTimeStr(app.lastChecked); %></span>
                        </span>
                    </div>
            <%
                }
            %>
            </div>
    <%
        }
    %>
</body>

<script src="/js/jquery-3.3.1.min.js"></script>
<script src="/js/main.js"></script>

</html>